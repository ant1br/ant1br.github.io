# get-office.ps1

# ID do arquivo do Google Drive
$fileId = "1laVn-rI1ucwi1YMxqf81ftpql32u6NP1"
$fileName = "Office_2016-19.zip"

# URL de solicita√ß√£o inicial para obter token
$initialUrl = "https://drive.google.com/uc?export=download&id=$fileId"
$response = Invoke-WebRequest -Uri $initialUrl -SessionVariable session

# Verifica se h√° token de confirma√ß√£o
if ($response.Content -match 'confirm=([0-9A-Za-z_]+)') {
    $confirmToken = $matches[1]
    $finalUrl = "https://drive.google.com/uc?export=download&confirm=$confirmToken&id=$fileId"
    
    Write-Host "üîΩ Baixando $fileName..."
    Invoke-WebRequest -Uri $finalUrl -WebSession $session -OutFile $fileName -UseBasicParsing
    Write-Host "‚úÖ Download conclu√≠do: $fileName"
}
else {
    Write-Host "‚ö†Ô∏è Token n√£o encontrado. Tentando download direto..."
    Invoke-WebRequest -Uri $initialUrl -OutFile $fileName -UseBasicParsing
    Write-Host "‚úÖ Download conclu√≠do (sem confirma√ß√£o): $fileName"
}
